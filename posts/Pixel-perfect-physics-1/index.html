<!DOCTYPE html><html lang="fr-FR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="[1/3] Réaliser sa propre physique pour du Pixel Art" /><meta property="og:locale" content="fr_FR" /><meta name="description" content="[1/3] Intro &amp; AABB" /><meta property="og:description" content="[1/3] Intro &amp; AABB" /><link rel="canonical" href="https://carbone13.github.io//posts/Pixel-perfect-physics-1/" /><meta property="og:url" content="https://carbone13.github.io//posts/Pixel-perfect-physics-1/" /><meta property="og:site_name" content="Carbone_13 Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-08T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[1/3] Réaliser sa propre physique pour du Pixel Art" /><meta name="twitter:site" content="@mchl_lucas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"[1/3] Intro &amp; AABB","url":"https://carbone13.github.io//posts/Pixel-perfect-physics-1/","@type":"BlogPosting","headline":"[1/3] Réaliser sa propre physique pour du Pixel Art","dateModified":"2021-04-10T23:33:56+02:00","datePublished":"2021-04-08T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://carbone13.github.io//posts/Pixel-perfect-physics-1/"},"@context":"https://schema.org"}</script><title>[1/3] Réaliser sa propre physique pour du Pixel Art | Carbone_13 | Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/rounded.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Carbone_13 | Blog</a></div><div class="site-subtitle font-italic">Fait mu-muse avec des pixels</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>PAR CATÉGORIE</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>À PROPOS DE MOI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Carbone13" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/mchl_lucas" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['lucas.michaudel','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>[1/3] Réaliser sa propre physique pour du Pixel Art</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Rechercher..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[1/3] Réaliser sa propre physique pour du Pixel Art</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Lucas Michaudel </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Apr 8, 2021, 12:00 AM +0200" prep="on" > Apr 8 <i class="unloaded">2021-04-08T00:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Apr 10, 2021, 11:33 PM +0200" prefix="Updated " > Apr 10 <i class="unloaded">2021-04-10T23:33:56+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="981 words">5 min</span></div></div><div class="post-content"><h1 id="13--intro--aabb">[1/3] Intro &amp; AABB</h1><hr /><p class="text-justify">Lorsqu’on souhaite réaliser un jeu en 2D sur Unity, on peut se laisser tenter par son système de Physique et de Collisions. Malheureusement il est assez laborieux d’avoir un résultat convaincant avec, surtout lorsqu’on développe un Platformer. Maintenant il est toujours possible d’utiliser la fonction MovePosition() d’un rigidbody, mais le système de collision est assez strict.</p><p>C’est pourquoi aujourd’hui je vais vous apprendre à réaliser vous même un système de collision. Ce dernier est inspiré du célèbre jeu Céleste. Avant de commencer il y a quelque contrainte à prendre en compte :</p><ul class="text-justify"><li>Chaque Acteur ne peut se déplacer que d’un pixel par un pixel.<li>Chaque boîte de collision est forcément une AABB (<strong>A</strong>xis <strong>A</strong>ligned <strong>B</strong>ounding <strong>B</strong>ox), c’est à dire un rectangle non tourné.<li>Les tailles des boîtes ainsi que les positions de chaque entités sont des nombres entiers.</ul><p class="text-justify">Les scripts complets sont disponibles à la fin de chaque articles. Les sources complètes des projets sont disponibles à la fin de chaque série d’article compressé en .zip</p><h1 id="les-boîtes-de-collisions">Les boîtes de collisions</h1><hr /><p class="text-justify">Comme je viens de le dire, la seule forme que notre système va pouvoir gérer sont les rectangles. Il faut donc bien comprendre qu’il faut faire une croix sur les pentes ou autres forme farfelues.</p><p>Pour être conforme à ses boîtes et au système en général, nos sprites vont devoir respecter certaines règles :</p><ul class="text-justify"><li>Leur pivot doit être positionner sur un pixel du sprite, et pas entre 2 pixels.<li>Leur PPU (<strong>P</strong>ixel <strong>p</strong>er <strong>U</strong>nit) doit être à 1, ainsi 1 pixel de notre sprite sera égal à 1 unité sur Unity.<li>Optionnel mais recommandé pour du pixel art : Désactiver la compression (“None”) et passer le Filter Mode en “Point”</ul><p class="text-justify">Maintenant passons aux choses sérieuses. Pour représenter nos boîtes nous allons crée une classe nommée “Rectangle.cs”. En soit je préfère l’appeler ‘AABB’ mais l’éditeur Unity la fait entrer en conflit avec une classe du même nom. Nous n’allons pas tout faire de A à Z, il existe déjà une structure permettant de représenter un carré avec des dimensions en pixels (rappelez vous, contraintes n°3), il s’agit de RectInt !</p><p class="text-justify">On commence par déclarer 2 Vector2Int qui serviront à renseigner une taille en pixel ainsi qu’un offset lui aussi en pixel.</p><p class="text-justify">J’ajoute aussi une <code class="language-plaintext highlighter-rouge">boolean</code> “Collidable” qui permet de désactiver la boîte si besoin.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Rectangle</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
	<span class="k">public</span> <span class="n">Vector2Int</span> <span class="n">size</span><span class="p">;</span>
	<span class="k">public</span> <span class="n">Vector2Int</span> <span class="n">offset</span><span class="p">;</span>

	<span class="k">public</span> <span class="kt">bool</span> <span class="n">Collidable</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p class="text-justify">Maintenant, les autres scripts doivent pouvoir récupérer un <code class="language-plaintext highlighter-rouge">RectInt</code> qui correspond à notre boite dans la scène. Nous allons donc ajouter une variable avec un simple getter qui va permettre de “générer” ce Rect. Il faut aussi penser à prendre en compte la position de l’objet dans la scène.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="n">RectInt</span> <span class="n">Bounds</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">RectInt</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="nf">v2i</span><span class="p">()</span> <span class="p">+</span> <span class="n">Offset</span><span class="p">,</span> <span class="n">Size</span><span class="p">);</span>
</pre></table></code></div></div><p class="text-justify">Vous remarquez que j’utilise la fonction <code class="language-plaintext highlighter-rouge">v2i()</code> sur mon Vector3, c’est une fonction que j’ai crée qui permet de convertir un Vector3 ou en Vector2 en Vector2Int, car rappelez vous, nous travaillons en pixel entier donc avec des nombres entiers.</p><p class="text-justify">Pour les intéresser la voici (à mettre dans une classe statique elle aussi) :</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">static</span> <span class="n">Vector2Int</span> <span class="nf">v2i</span> <span class="p">(</span><span class="k">this</span> <span class="n">Vector3</span> <span class="n">input</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="k">new</span> <span class="nf">Vector2Int</span><span class="p">(</span><span class="n">Mathf</span><span class="p">.</span><span class="nf">RoundToInt</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">RoundToInt</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">static</span> <span class="n">Vector2Int</span> <span class="nf">v2i</span> <span class="p">(</span><span class="k">this</span> <span class="n">Vector2</span> <span class="n">input</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="k">new</span> <span class="nf">Vector2Int</span><span class="p">(</span><span class="n">Mathf</span><span class="p">.</span><span class="nf">RoundToInt</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">RoundToInt</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p class="text-justify">Pour terminer nos boîtes, j’aimerais ajouter une petite fonction de Debug permettant de les visualiser. Pour se faire, j’utilise la fonction <code class="language-plaintext highlighter-rouge">DrawWireCube()</code> de <code class="language-plaintext highlighter-rouge">Gizmos</code>, qui permet de dessiner les arêtes d’un rectangle. Le rectangle étant donc notre <code class="language-plaintext highlighter-rouge">RectInt</code> “bounds”</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">void</span> <span class="nf">OnDrawGizmos</span> <span class="p">()</span>
<span class="p">{</span>
	<span class="n">Gizmos</span><span class="p">.</span><span class="nf">DrawWireCube</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">center</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Notre classe rectangle ressemblant donc au final à ça :</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Rectangle</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
	<span class="k">public</span> <span class="n">Vector2Int</span> <span class="n">size</span><span class="p">;</span>
	<span class="k">public</span> <span class="n">Vector2Int</span> <span class="n">offset</span><span class="p">;</span>

	<span class="k">public</span> <span class="kt">bool</span> <span class="n">collidable</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

	<span class="k">public</span> <span class="n">RectInt</span> <span class="n">Bounds</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">RectInt</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="nf">v2i</span><span class="p">()</span> <span class="p">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>


	<span class="c1">// Editor Functions</span>
	<span class="k">public</span> <span class="k">void</span> <span class="nf">OnDrawGizmos</span> <span class="p">()</span>
	<span class="p">{</span>
		<span class="n">Gizmos</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">green</span><span class="p">;</span>
		<span class="n">Gizmos</span><span class="p">.</span><span class="nf">DrawWireCube</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">center</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Résultat final en scène : <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pixelartphysic/HelenaWithCollider.jpg" alt="Héléna avec sa boîte de collision" /></p><h1 id="le-trackeur">Le Trackeur</h1><hr /><p class="text-justify">Maintenant que nous avons nos boîtes, il va falloir les tracker pour les retrouver facilement. Pour détecter si une boîte A collisione avec une autre boîte dans la scène, nous n’avons pas d’autre choix que de la tester contre toutes les autres. Si l’on considère une scène avec n acteurs, chaque acteur devras vérifier s’il collisione avec chacun des autres acteurs, cela donne donc un problème de type O(n²). Nous verrons dans un futur poste un moyen d’optimiser tout ça.</p><p class="text-justify">Revenons en à notre Tracker, j’ai décidé d’utiliser une classe statique qui n’est pas instancié sur Unity, mais vous pouvez très bien la faire dériver de <code class="language-plaintext highlighter-rouge">MonoBehaviour</code> et l’ajouter sur un GameObject “Manager”. Cette classe ne possède qu’une liste de Rectangles accessible à tous :</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">Tracker</span>
<span class="p">{</span>
	<span class="k">public</span> <span class="k">static</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Rectangle</span><span class="p">&gt;</span> <span class="n">colliders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Rectangle</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Il ne reste plus qu’à ajouter nos boîtes dans cette liste, pour se faire j’utilise les fonctions <code class="language-plaintext highlighter-rouge">OnEnable()</code> et <code class="language-plaintext highlighter-rouge">OnDisable()</code> de <code class="language-plaintext highlighter-rouge">MonoBehaviour</code> dans ma classe Rectangle :</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Rectangle</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
	<span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="n">Vector2Int</span> <span class="n">size</span><span class="p">;</span>
	<span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="n">Vector2Int</span> <span class="n">offset</span><span class="p">;</span>

	<span class="k">public</span> <span class="kt">bool</span> <span class="n">collidable</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

	<span class="k">public</span> <span class="n">RectInt</span> <span class="n">Bounds</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">RectInt</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="nf">v2i</span><span class="p">()</span> <span class="p">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>


	<span class="c1">// Editor Functions</span>
	<span class="k">public</span> <span class="k">void</span> <span class="nf">OnDrawGizmos</span> <span class="p">()</span>
	<span class="p">{</span>
		<span class="n">Gizmos</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">green</span><span class="p">;</span>
		<span class="n">Gizmos</span><span class="p">.</span><span class="nf">DrawWireCube</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">center</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">Bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="k">public</span> <span class="k">void</span> <span class="nf">OnEnable</span> <span class="p">()</span>
	<span class="p">{</span>
		<span class="n">Tracker</span><span class="p">.</span><span class="n">colliders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">public</span> <span class="k">void</span> <span class="nf">OnDisable</span> <span class="p">()</span>
	<span class="p">{</span>
		<span class="n">Tracker</span><span class="p">.</span><span class="n">colliders</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p class="text-justify">Vous pouvez maintenant ajouter des obstacles dans votre scène. Pour leur ajouter des colliders, il suffit de leur ajouter le composant Rectangle. Noter que vous n’êtes pas limité quant au nombre de Rectangle par Game Object.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/2d/'>2D</a>, <a href='/categories/physic/'>Physic</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Partager</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[1/3] Réaliser sa propre physique pour du Pixel Art - Carbone_13 | Blog&url=https://carbone13.github.io//posts/Pixel-perfect-physics-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[1/3] Réaliser sa propre physique pour du Pixel Art - Carbone_13 | Blog&u=https://carbone13.github.io//posts/Pixel-perfect-physics-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[1/3] Réaliser sa propre physique pour du Pixel Art - Carbone_13 | Blog&url=https://carbone13.github.io//posts/Pixel-perfect-physics-1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Récent</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Pixel-perfect-physics-1/">[1/3] Réaliser sa propre physique pour du Pixel Art</a><li><a href="/posts/Pixel-perfect-physics-2/">[2/3] Réaliser sa propre physique pour du Pixel Art</a><li><a href="/posts/Pixel-perfect-physics-3/">[3/3] Réaliser sa propre physique pour du Pixel Art</a></ul></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Autres articles</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Pixel-perfect-physics-2/"><div class="card-body"> <span class="timeago small" > Apr 9 <i class="unloaded">2021-04-09T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[2/3] Réaliser sa propre physique pour du Pixel Art</h3><div class="text-muted small"><p> [2/3] Les Acteurs Dans le précédent article, j’ai plusieurs fois parler d’Acteur, en fait un Acteur désigne une entité qui va se déplacer dans la scène tout en collisionant avec les autres boît...</p></div></div></a></div><div class="card"> <a href="/posts/Pixel-perfect-physics-3/"><div class="card-body"> <span class="timeago small" > Apr 10 <i class="unloaded">2021-04-10T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[3/3] Réaliser sa propre physique pour du Pixel Art</h3><div class="text-muted small"><p> [3/3] Les Solides Maintenant que nous en avons terminé avec les Acteurs, il est temps de s’attaquer au deuxième type d’entité : les Solides. Ce que j’appelle un Solide, c’est une entité qui se ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Précédent"><p>-</p></span> <a href="/posts/Pixel-perfect-physics-2/" class="btn btn-outline-primary" prompt="Suivant"><p>[2/3] Réaliser sa propre physique pour du Pixel Art</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/Carbone13">Lucas Michaudel</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://carbone13.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
